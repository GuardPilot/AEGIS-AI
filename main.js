// i18n dictionary (EN default, RU provided)
const i18n = {
  en: {
    nav_contact: "Contact",
    hero_title: "Autonomous AI Security Drones for 24/7 Protection",
    hero_sub: "AegisAI combines advanced computer vision with enterprise drones to prevent intrusions before they escalate.",
    btn_pitch: "Download Pitch Deck (PDF)",
    btn_learn: "Learn more",
    badge_inprogress: "In Progress",
    badge_cto: "Open Roles: CTO",
    chip_demo: "Demo preview",

    problem_title: "Problem",
    problem_text: "Traditional security lacks continuous coverage, rapid response, and real-time analytics. Human fatigue and blind spots lead to missed incidents and rising costs.",
    solution_title: "Solution",
    solution_text: "AegisAI deploys autonomous patrol drones with AI detection to identify risks early, deter intruders, and stream alerts to operators—reducing response time and total cost of ownership.",

    whynow_title: "Why Now",
    whynow_item1_t: "Mature enterprise drones",
    whynow_item1_d: "DJI Enterprise Matrice 30T-class hardware enables reliable all-weather patrols.",
    whynow_item2_t: "On-device AI",
    whynow_item2_d: "Efficient computer vision models now run at the edge for faster, safer decisions.",
    whynow_item3_t: "Operational pressure",
    whynow_item3_d: "Security teams face labor shortages and rising costs—automation multiplies coverage.",

    tech_title: "Technology",
    tech_stack_t: "Stack",
    tech_item1: "DJI Enterprise Matrice 30T platform",
    tech_item2: "Autonomous navigation + remote wireless charging",
    tech_item3: "Edge AI (vision) for detection & tracking",
    tech_item4: "Secure app for alerts, review, and escalation",
    tech_item5: "Non‑lethal deterrent payload (pepper‑spray canister)",
    tech_safety_t: "Safety & Compliance",
    tech_s1: "Fail-safes: return‑to‑home, geo‑fencing, manual override",
    tech_s2: "Audit logs, role-based access, encryption in transit",
    tech_s3: "Local laws and site policies respected during operation",

    market_title: "Market & Metrics",
    market_card1_h: "TAM / SAM / SOM",
    market_card1_p: "Methodology in progress. No speculative figures. Results to be published post‑validation.",
    market_card1_m1: "Methodology: bottom‑up (site count × patrol hours × ASP)",
    market_card1_m2: "Sources: buyer interviews, public procurement data",

    market_card2_h: "Pilot Pipeline",
    market_card2_p: "Prospect discovery and requirements mapping underway with early adopters.",
    market_card2_m1: "Methodology: structured intake + site audit",
    market_card2_m2: "Artifacts: MoSCoW backlog, success metrics",

    market_card3_h: "Unit Economics",
    market_card3_p: "Cost model = hardware (BOM) + charging + software + ops. Publish after pilot.",
    market_card3_m1: "Approach: cohort LTV/CAC, payback target",
    market_card3_m2: "Evidence: field logs, downtime analysis",
    badge_research: "Research",
    badge_method: "Methodology",

    roadmap_title: "Roadmap",
    rd1_t: "MVP assembly & bench tests",
    rd1_d: "Integrate platform, edge vision, remote charging. Validate core flows.",
    rd2_t: "Field pilots",
    rd2_d: "Deploy supervised pilots on private sites with explicit policies and KPIs.",
    rd3_t: "v1 Launch",
    rd3_d: "Subscription model, support SLAs, and onboarding playbooks.",

    team_title: "Team & Founder",
    team_text: "Founder & CEO: Roman Chaikin — product & operations. Building AegisAI with a focus on safety, reliability, and clear economics.",
    badge_openroles: "Open Roles",
    cto_title: "CTO Search",
    cto_text: "Looking for a hands‑on co‑founder: robotics/controls, computer vision, systems integration, and secure cloud.",
    cto_req1: "Experience: robotics or autonomous systems",
    cto_req2: "Edge ML / CV deployment",
    cto_req3: "Hardware‑software integration",

    status_title: "Current Status",
    st1: "Brand & landing established",
    st2: "MVP parts sourcing & prototyping",
    st3: "Pilot criteria & safety checklist",

    ask_title: "Investment Ask",
    ask_text: "Raising to complete MVP, run pilots, and reach v1 readiness.",
    ask_use1: "Use of funds: hardware, engineering, pilots",
    ask_use2: "Runway targets aligned with milestones",
    ask_note: "No inflated claims or fabricated metrics. We publish results after methodical validation.",

    contact_title: "Contact",
    form_title: "Get the Pitch Deck",
    form_name: "Name",
    form_company: "Company",
    form_email: "Email",
    form_submit: "Request deck",

    disc_general: "Disclaimer: Flight operations comply with local laws, site policies, and safety constraints. Deterrent payloads used only where permitted.",
    privacy_title: "Privacy Policy",
    privacy_text: "We collect contact details you submit to share the pitch deck and updates. Data is stored securely and never sold. To remove your data, email us."
  },
  ru: {
    nav_contact: "Контакты",
    hero_title: "Автономные дроны безопасности с ИИ для 24/7 охраны",
    hero_sub: "AegisAI сочетает компьютерное зрение и промышленные дроны, чтобы предотвращать инциденты до их эскалации.",
    btn_pitch: "Скачать Pitch Deck (PDF)",
    btn_learn: "Узнать больше",
    badge_inprogress: "В работе",
    badge_cto: "Открыта роль: CTO",
    chip_demo: "Демо‑превью",

    problem_title: "Проблема",
    problem_text: "Классическая охрана не обеспечивает непрерывный контроль, быструю реакцию и аналитику в реальном времени. Человеческая усталость и «слепые зоны» ведут к пропускам инцидентов и росту затрат.",
    solution_title: "Решение",
    solution_text: "AegisAI развёртывает автономные патрульные дроны с ИИ‑детекцией: раннее выявление рисков, сдерживание нарушителей и мгновенные алерты операторам — меньше время реакции и TCO.",

    whynow_title: "Почему сейчас",
    whynow_item1_t: "Зрелые платформы",
    whynow_item1_d: "Аппараты класса DJI Enterprise Matrice 30T обеспечивают надёжные патрули при любой погоде.",
    whynow_item2_t: "ИИ «на борту»",
    whynow_item2_d: "Эффективные модели зрения работают на краю, ускоряя и повышая безопасность решений.",
    whynow_item3_t: "Операционное давление",
    whynow_item3_d: "Дефицит кадров и рост затрат — автоматизация кратно расширяет покрытие.",

    tech_title: "Технологии",
    tech_stack_t: "Стек",
    tech_item1: "Платформа DJI Enterprise Matrice 30T",
    tech_item2: "Автономная навигация + дистанционная беспроводная зарядка",
    tech_item3: "Edge‑ИИ (зрение) для детекции и трекинга",
    tech_item4: "Безопасное приложение для алертов, разбора и эскалации",
    tech_item5: "Нелетальная нагрузка (перцовый баллон)",

    tech_safety_t: "Безопасность и соответствие",
    tech_s1: "Фейл‑сейфы: возврат домой, геозоны, ручное вмешательство",
    tech_s2: "Аудит‑логи, роли и права, шифрование трафика",
    tech_s3: "Соблюдение местных законов и правил площадки",

    market_title: "Рынок и метрики",
    market_card1_h: "TAM / SAM / SOM",
    market_card1_p: "Методология в работе. Без спекулятивных цифр. Публикуем результаты после валидации.",
    market_card1_m1: "Метод: bottom‑up (кол-во объектов × часы патруля × ASP)",
    market_card1_m2: "Источники: интервью с покупателями, госзакупки",

    market_card2_h: "Пайплайн пилотов",
    market_card2_p: "Поиск пилотов и сбор требований с первыми заказчиками.",
    market_card2_m1: "Метод: структурированный intake + аудит площадки",
    market_card2_m2: "Артефакты: бэклог MoSCoW, метрики успеха",

    market_card3_h: "Unit‑экономика",
    market_card3_p: "Модель затрат = железо (BOM) + зарядка + софт + операции. Публикуем после пилотов.",
    market_card3_m1: "Подход: LTV/CAC по когортам, цель окупаемости",
    market_card3_m2: "Данные: полевые логи, анализ простоев",
    badge_research: "Research",
    badge_method: "Methodology",

    roadmap_title: "Дорожная карта",
    rd1_t: "Сборка MVP и стендовые тесты",
    rd1_d: "Интеграция платформы, edge‑зрения и удалённой зарядки. Проверка ключевых сценариев.",
    rd2_t: "Полевые пилоты",
    rd2_d: "Запуск под присмотром на частных объектах с чёткими правилами и KPI.",
    rd3_t: "Запуск v1",
    rd3_d: "Подписка, SLA‑поддержка и онбординг‑плейбуки.",

    team_title: "Команда и основатель",
    team_text: "Основатель и CEO: Роман Чайкин — продукт и операции. Строит AegisAI с упором на безопасность, надёжность и понятную экономику.",
    badge_openroles: "Открытые роли",
    cto_title: "Поиск CTO",
    cto_text: "Ищем ко‑фаундера‑практика: робототехника/управление, компьютерное зрение, системная интеграция и безопасное облако.",
    cto_req1: "Опыт: робототехника или автономные системы",
    cto_req2: "Деплой ML/CV на краю",
    cto_req3: "Интеграция «железо+софт»",

    status_title: "Текущий статус",
    st1: "Бренд и лендинг готовы",
    st2: "Закупка компонентов и прототипирование MVP",
    st3: "Критерии пилотов и чек‑лист безопасности",

    ask_title: "Инвестиционный запрос",
    ask_text: "Раунд на завершение MVP, пилоты и подготовку v1.",
    ask_use1: "Статьи: железо, инженеры, пилоты",
    ask_use2: "Runway согласован с вехами",
    ask_note: "Без завышенных обещаний и выдуманных цифр. Публикуем результаты после методичной валидации.",

    contact_title: "Контакты",
    form_title: "Получить Pitch Deck",
    form_name: "Имя",
    form_company: "Компания",
    form_email: "Email",
    form_submit: "Запросить",

    disc_general: "Дисклеймер: Полёты соответствуют законам, правилам площадки и требованиям безопасности. Нелетальные нагрузки используются только там, где это разрешено.",
    privacy_title: "Политика конфиденциальности",
    privacy_text: "Мы собираем контакты, которые вы отправляете, чтобы поделиться пич‑деком и обновлениями. Данные храним безопасно и не продаём. Для удаления напишите нам."
  }
};

// Config: set this to your hosted PDF when available
const PITCH_DECK_URL = "assets/GuardPilot_PitchDeck_Light.pdf";
const PITCH_DECK_LABEL = "PDF";

function setLang(lang) {
  const dict = i18n[lang] || i18n.en;
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (dict[key]) el.textContent = dict[key];
  });
  localStorage.setItem("aegisai_lang", lang);
  document.documentElement.lang = lang === "ru" ? "ru" : "en";
}

function toggleLang() {
  const current = localStorage.getItem("aegisai_lang") || "en";
  setLang(current === "en" ? "ru" : "en");
}

function initLang() {
  const saved = localStorage.getItem("aegisai_lang");
  if (saved === "ru" || saved === "en") setLang(saved);
  else setLang("en");
}

function openPitchModal() {
  document.getElementById("pitch-modal").hidden = false;
}
function closePitchModal() {
  document.getElementById("pitch-modal").hidden = true;
}

function handleForm(form, resultEl) {
  form.addEventListener("submit", (e) => {
    e.preventDefault();
    const fd = new FormData(form);
    const name = (fd.get("name") || "").toString().trim();
    const company = (fd.get("company") || "").toString().trim();
    const email = (fd.get("email") || "").toString().trim();

    // Simple email validation
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      resultEl.textContent = (document.documentElement.lang === "ru") ? "Некорректный email." : "Invalid email.";
      return;
    }

    // Optional: integrate EmailJS or your backend here
    // window.emailjs && emailjs.send(...)

    if (PITCH_DECK_URL) {
      const msg = (document.documentElement.lang === "ru") ? "Готово! Скачать: " : "Done! Download: ";
      const label = (typeof PITCH_DECK_LABEL === "string" && PITCH_DECK_LABEL) ? PITCH_DECK_LABEL : "PDF";
      resultEl.innerHTML = msg + `<a href="${PITCH_DECK_URL}" target="_blank" rel="noopener">${label}</a>`;
    } else {
      const msg = (document.documentElement.lang === "ru") ? "Мы отправим вам дек в ближайшее время." : "We’ll send you the deck soon.";
      resultEl.textContent = msg;
    }

    form.reset();
  });
}

window.addEventListener("DOMContentLoaded", () => {
  document.getElementById("lang-toggle").addEventListener("click", toggleLang);
  initLang();

  // year
  const y = new Date().getFullYear();
  const yEl = document.getElementById("year");
  if (yEl) yEl.textContent = y;

  // pitch modals/buttons
  document.getElementById("open-pitch").addEventListener("click", openPitchModal);
  document.getElementById("open-pitch-2").addEventListener("click", openPitchModal);
  document.querySelector("#pitch-modal .close").addEventListener("click", closePitchModal);
  document.getElementById("pitch-modal").addEventListener("click", (e) => {
    if (e.target.id === "pitch-modal") closePitchModal();
  });

  handleForm(document.getElementById("pitch-form"), document.getElementById("form-result"));
  handleForm(document.getElementById("pitch-form-modal"), document.getElementById("form-result-modal"));
});
